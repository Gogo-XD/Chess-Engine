#include "bitboards.h"
#include "evaluation.h"
#include "moves.h"

#include <iostream>

using namespace std;

static const double WhitePawnPSQ[64] = {
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    1.3, 1.3, 1.3, 1.3, 1.3, 1.3, 1.3, 1.3,
    1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2,
    1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2,
    1.1, 1.1, 1.2, 1.2, 1.2, 1.2, 1.1, 1.1,
    1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1,
    1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};

static const double BlackPawnPSQ[64] = {
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1,
    1.1, 1.1, 1.2, 1.2, 1.2, 1.2, 1.1, 1.1,
    1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2,
    1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2,
    1.3, 1.3, 1.3, 1.3, 1.3, 1.3, 1.3, 1.3,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0};

static const double WhiteKnightPSQ[64] = {
    2.5, 2.5, 2.7, 2.7, 2.7, 2.7, 2.5, 2.5,
    2.5, 2.7, 3.0, 3.0, 3.0, 3.0, 2.7, 2.5,
    2.7, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 2.7,
    3.0, 3.0, 3.0, 3.3, 3.3, 3.0, 3.0, 3.0,
    3.0, 3.0, 3.0, 3.3, 3.3, 3.0, 3.0, 3.0,
    2.7, 3.0, 3.3, 3.0, 3.0, 3.3, 3.0, 2.7,
    2.5, 2.7, 3.0, 3.0, 3.0, 3.0, 2.7, 2.5,
    2.5, 2.5, 2.7, 2.7, 2.7, 2.7, 2.5, 2.5};

static const double BlackKnightPSQ[64] = {
    2.5, 2.5, 2.7, 2.7, 2.7, 2.7, 2.5, 2.5,
    2.5, 2.7, 3.0, 3.0, 3.0, 3.0, 2.7, 2.5,
    2.7, 3.0, 3.3, 3.0, 3.0, 3.3, 3.0, 2.7,
    3.0, 3.0, 3.0, 3.3, 3.3, 3.0, 3.0, 3.0,
    3.0, 3.0, 3.0, 3.3, 3.3, 3.0, 3.0, 3.0,
    2.7, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 2.7,
    2.5, 2.7, 3.0, 3.0, 3.0, 3.0, 2.7, 2.5,
    2.5, 2.5, 2.7, 2.7, 2.7, 2.7, 2.5, 2.5};

static const double WhiteBishopPSQ[64] = {
    3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0,
    3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0,
    3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0,
    3.0, 3.2, 3.0, 3.0, 3.0, 3.0, 3.2, 3.0,
    3.0, 3.0, 3.2, 3.0, 3.0, 3.2, 3.0, 3.0,
    3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0,
    3.0, 3.2, 3.0, 3.0, 3.0, 3.0, 3.2, 3.0,
    3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0};

static const double BlackBishopPSQ[64] = {
    3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0,
    3.0, 3.2, 3.0, 3.0, 3.0, 3.0, 3.2, 3.0,
    3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0,
    3.0, 3.0, 3.2, 3.0, 3.0, 3.2, 3.0, 3.0,
    3.0, 3.2, 3.0, 3.0, 3.0, 3.0, 3.2, 3.0,
    3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0,
    3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0,
    3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0};

static const double WhiteRookPSQ[64] = {
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0};

static const double BlackRookPSQ[64] = {
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0,
    5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0};

static const double WhiteQueenPSQ[64] = {
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0};

static const double BlackQueenPSQ[64] = {
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,
    9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0};

double pieceEvaluation(uint64_t bitboard, const double PSQ[64], std::string temp)
{
    double value = 0.0;
    int square = 0;

    while (bitboard)
    {
        if (bitboard & 1ULL)
        {
            value += PSQ[square];
        }

        bitboard >>= 1;
        square++;
    }

    return value;
}

double evaluateBoard(Bitboards bitboards)
{
    double value = 0.0;

    value += pieceEvaluation(bitboards.whitePawns, WhitePawnPSQ, "wp");
    value += pieceEvaluation(bitboards.whiteKnights, WhiteKnightPSQ, "wk");
    value += pieceEvaluation(bitboards.whiteBishops, WhiteBishopPSQ, "wb");
    value += pieceEvaluation(bitboards.whiteRooks, WhiteRookPSQ, "wr");
    value += pieceEvaluation(bitboards.whiteQueens, WhiteQueenPSQ, "wq");

    value -= pieceEvaluation(bitboards.blackPawns, BlackPawnPSQ, "bp");
    value -= pieceEvaluation(bitboards.blackKnights, BlackKnightPSQ, "bk");
    value -= pieceEvaluation(bitboards.blackBishops, BlackBishopPSQ, "bb");
    value -= pieceEvaluation(bitboards.blackRooks, BlackRookPSQ, "br");
    value -= pieceEvaluation(bitboards.blackQueens, BlackQueenPSQ, "bq");

    return value;
}